{
  "domain": "consul",
  "datacenter": "{{ datacenter_name }}",
  "node_name": "{{ inventory_hostname }}",
  "bind_addr": "{{ ansible_host }}",
  "client_addr": "0.0.0.0",
  "data_dir": "/var/lib/consul",
  "encrypt": "{{ consul_encrypt_key }}",
  "log_level": "INFO",
  "log_file": "/var/log/consul/consul",
  "server": true,
  "bootstrap_expect": 3,
  "ui_config": { "enabled": true },
  "leave_on_terminate": true,
  "rejoin_after_leave": true,
  "retry_join": {{ consul_server_ips | to_json }},
  "acl": {
    "enabled": true,
    "default_policy": "deny",
    "enable_token_persistence": true,
    "tokens": {
      "default": "anonymous",
      "agent": "{{ consul_master_token }}",
      "initial_management": "{{ consul_master_token }}"
    }
  }
}
